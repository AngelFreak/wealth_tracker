{{define "content"}}
<div class="space-y-6">
    <!-- Page Header -->
    <div>
        <h1 class="text-2xl font-semibold text-gray-900 dark:text-white">
            Settings
        </h1>
        <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Manage your account and preferences</p>
    </div>

    {{if .Error}}
    <div class="bg-red-500/10 border border-red-500/20 rounded-lg p-4">
        <div class="flex items-center gap-2">
            <i data-lucide="alert-circle" class="w-5 h-5 text-red-500"></i>
            <p class="text-sm text-red-400">{{.Error}}</p>
        </div>
    </div>
    {{end}}

    {{if .Success}}
    <div class="bg-emerald-500/10 border border-emerald-500/20 rounded-lg p-4">
        <div class="flex items-center gap-2">
            <i data-lucide="check-circle" class="w-5 h-5 text-emerald-500"></i>
            <p class="text-sm text-emerald-400">{{.Success}}</p>
        </div>
    </div>
    {{end}}

    <form action="/settings" method="POST" class="space-y-6">
        <!-- Profile Section -->
        <div class="rounded-2xl bg-white dark:bg-dark-surface border border-gray-200 dark:border-dark-border overflow-hidden">
            <!-- Header -->
            <div class="flex items-center gap-3 px-6 py-5 border-b border-gray-200 dark:border-dark-border">
                <div class="w-10 h-10 rounded-xl gradient-indigo flex items-center justify-center">
                    <i data-lucide="user" class="w-5 h-5 text-white"></i>
                </div>
                <div>
                    <h2 class="text-lg font-semibold text-gray-900 dark:text-white">Profile</h2>
                    <p class="text-xs text-gray-500 dark:text-gray-400">Your personal information</p>
                </div>
            </div>

            <!-- Body -->
            <div class="p-6 space-y-5">
                <!-- Display Name -->
                <div>
                    <label class="block text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">
                        Display Name
                    </label>
                    <input type="text" name="name" value="{{.User.Name}}" required
                        class="w-full px-4 py-3 rounded-xl bg-gray-50 dark:bg-dark-bg border border-gray-200 dark:border-dark-border text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 transition-all"
                        placeholder="Your name">
                </div>

                <!-- Email (read-only) -->
                <div>
                    <label class="block text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">
                        Email Address
                    </label>
                    <div class="flex items-center gap-2">
                        <input type="email" value="{{.User.Email}}" readonly disabled
                            class="flex-1 px-4 py-3 rounded-xl bg-gray-100 dark:bg-dark-hover border border-gray-200 dark:border-dark-border text-gray-500 dark:text-gray-400 cursor-not-allowed">
                        <span class="px-3 py-1.5 rounded-full bg-gray-100 dark:bg-dark-hover text-xs text-gray-500 dark:text-gray-400 border border-gray-200 dark:border-dark-border">
                            <i data-lucide="lock" class="w-3 h-3 inline"></i>
                            Locked
                        </span>
                    </div>
                    <p class="mt-1 text-xs text-gray-400">Contact support to change your email</p>
                </div>
            </div>
        </div>

        <!-- Preferences Section -->
        <div class="rounded-2xl bg-white dark:bg-dark-surface border border-gray-200 dark:border-dark-border overflow-hidden">
            <!-- Header -->
            <div class="flex items-center gap-3 px-6 py-5 border-b border-gray-200 dark:border-dark-border">
                <div class="w-10 h-10 rounded-xl gradient-amber flex items-center justify-center">
                    <i data-lucide="sliders" class="w-5 h-5 text-white"></i>
                </div>
                <div>
                    <h2 class="text-lg font-semibold text-gray-900 dark:text-white">Preferences</h2>
                    <p class="text-xs text-gray-500 dark:text-gray-400">Customize your experience</p>
                </div>
            </div>

            <!-- Body -->
            <div class="p-6 space-y-5">
                <!-- Default Currency -->
                <div>
                    <label class="block text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">
                        Default Currency
                    </label>
                    <select name="default_currency" class="select">
                        <option value="DKK" {{if eq .User.DefaultCurrency "DKK"}}selected{{end}}>DKK - Danish Krone</option>
                        <option value="EUR" {{if eq .User.DefaultCurrency "EUR"}}selected{{end}}>EUR - Euro</option>
                        <option value="USD" {{if eq .User.DefaultCurrency "USD"}}selected{{end}}>USD - US Dollar</option>
                        <option value="GBP" {{if eq .User.DefaultCurrency "GBP"}}selected{{end}}>GBP - British Pound</option>
                        <option value="SEK" {{if eq .User.DefaultCurrency "SEK"}}selected{{end}}>SEK - Swedish Krona</option>
                        <option value="NOK" {{if eq .User.DefaultCurrency "NOK"}}selected{{end}}>NOK - Norwegian Krone</option>
                    </select>
                    <p class="mt-1 text-xs text-gray-400">Used as default for new accounts and goals</p>
                </div>

                <!-- Number Format -->
                <div>
                    <label class="block text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">
                        Number Format
                    </label>
                    <select name="number_format" class="select">
                        <option value="da" {{if eq .User.NumberFormat "da"}}selected{{end}}>Danish (1.234.567,89)</option>
                        <option value="en" {{if eq .User.NumberFormat "en"}}selected{{end}}>English (1,234,567.89)</option>
                        <option value="fr" {{if eq .User.NumberFormat "fr"}}selected{{end}}>French (1 234 567,89)</option>
                    </select>
                    <p class="mt-1 text-xs text-gray-400">How numbers are displayed throughout the app</p>
                </div>

                <!-- Theme -->
                <div x-data="{ currentTheme: $store.theme.dark ? 'dark' : 'light' }">
                    <label class="block text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">
                        Theme
                    </label>
                    <div class="grid grid-cols-2 gap-3">
                        <label class="relative cursor-pointer">
                            <input type="radio" name="theme" value="dark"
                                   :checked="currentTheme === 'dark'"
                                   @change="currentTheme = 'dark'; $store.theme.dark = true; $store.theme.apply(); $store.theme.save()"
                                   class="peer sr-only">
                            <div class="p-4 rounded-xl border-2 border-gray-200 dark:border-dark-border peer-checked:border-amber-500 peer-checked:bg-amber-500/5 transition-all">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-lg bg-gray-900 flex items-center justify-center">
                                        <i data-lucide="moon" class="w-5 h-5 text-amber-500"></i>
                                    </div>
                                    <div>
                                        <p class="font-medium text-gray-900 dark:text-white">Dark</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-400">Easy on the eyes</p>
                                    </div>
                                </div>
                            </div>
                        </label>
                        <label class="relative cursor-pointer">
                            <input type="radio" name="theme" value="light"
                                   :checked="currentTheme === 'light'"
                                   @change="currentTheme = 'light'; $store.theme.dark = false; $store.theme.apply(); $store.theme.save()"
                                   class="peer sr-only">
                            <div class="p-4 rounded-xl border-2 border-gray-200 dark:border-dark-border peer-checked:border-amber-500 peer-checked:bg-amber-500/5 transition-all">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-lg bg-gray-100 flex items-center justify-center">
                                        <i data-lucide="sun" class="w-5 h-5 text-amber-500"></i>
                                    </div>
                                    <div>
                                        <p class="font-medium text-gray-900 dark:text-white">Light</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-400">Classic look</p>
                                    </div>
                                </div>
                            </div>
                        </label>
                    </div>
                    <p class="mt-2 text-xs text-gray-400">Theme changes apply immediately</p>
                </div>
            </div>
        </div>

        <!-- Save Button -->
        <div class="flex justify-end">
            <button type="submit" class="px-6 py-2.5 text-sm font-medium rounded-xl gradient-amber text-white shadow-lg shadow-amber-500/25 hover:shadow-amber-500/40 transition-all">
                Save Changes
            </button>
        </div>
    </form>

    <!-- Broker Connections -->
    <div class="rounded-2xl bg-white dark:bg-dark-surface border border-gray-200 dark:border-dark-border overflow-hidden">
        <!-- Header -->
        <div class="flex items-center gap-3 px-6 py-5 border-b border-gray-200 dark:border-dark-border">
            <div class="w-10 h-10 rounded-xl gradient-indigo flex items-center justify-center">
                <i data-lucide="link" class="w-5 h-5 text-white"></i>
            </div>
            <div>
                <h2 class="text-lg font-semibold text-gray-900 dark:text-white">Broker Connections</h2>
                <p class="text-xs text-gray-500 dark:text-gray-400">Connect your brokerage accounts for automatic updates</p>
            </div>
        </div>

        <!-- Body -->
        <div class="p-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="font-medium text-gray-900 dark:text-white">Manage Connections</p>
                    <p class="text-sm text-gray-500 dark:text-gray-400">Connect to Nordnet and other brokers to sync your portfolio</p>
                </div>
                <a href="/settings/connections"
                   class="px-4 py-2.5 text-xs font-medium rounded-lg bg-indigo-500/10 text-indigo-500 border border-indigo-500/30 hover:bg-indigo-500/20 transition-all flex items-center gap-2">
                    <i data-lucide="settings" class="w-4 h-4"></i>
                    Manage
                </a>
            </div>
        </div>
    </div>

    <!-- Danger Zone -->
    <div class="rounded-2xl bg-white dark:bg-dark-surface border border-red-200 dark:border-red-900/30 overflow-hidden">
        <!-- Header -->
        <div class="flex items-center gap-3 px-6 py-5 border-b border-red-200 dark:border-red-900/30 bg-red-50 dark:bg-red-900/10">
            <div class="w-10 h-10 rounded-xl gradient-rose flex items-center justify-center">
                <i data-lucide="alert-triangle" class="w-5 h-5 text-white"></i>
            </div>
            <div>
                <h2 class="text-lg font-semibold text-red-700 dark:text-red-400">Danger Zone</h2>
                <p class="text-xs text-red-600 dark:text-red-400/80">Irreversible actions</p>
            </div>
        </div>

        <!-- Body -->
        <div class="p-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="font-medium text-gray-900 dark:text-white">Delete Account</p>
                    <p class="text-sm text-gray-500 dark:text-gray-400">Permanently delete your account and all data</p>
                </div>
                <button type="button" x-data
                    @click="$store.confirm.show({
                        title: 'Delete Account',
                        message: 'Are you sure you want to permanently delete your account? All your data including accounts, transactions, categories, and goals will be lost forever.',
                        type: 'danger',
                        confirmText: 'Delete Account',
                        onConfirm: () => alert('Account deletion is not yet implemented. Contact support for assistance.')
                    })"
                    class="px-4 py-2.5 text-xs font-medium rounded-lg bg-red-500/10 text-red-500 border border-red-500/30 hover:bg-red-500/20 transition-all">
                    Delete Account
                </button>
            </div>
        </div>
    </div>
</div>

<script>
// Initialize Lucide icons after content loads
document.addEventListener('DOMContentLoaded', function() {
    if (typeof lucide !== 'undefined') {
        lucide.createIcons();
    }
});
</script>
{{end}}
